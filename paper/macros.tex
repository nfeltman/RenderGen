\newcommand {\TODO} {\textbf{TODO:} }

\definecolor{needsfixcolor}{rgb}{0.8,0.0,0.0}
\newcommand{\needsfix}[1]{{\color{needsfixcolor}\textbf{#1}}}

% core conventions and language names
\newcommand {\bbone} {\ensuremath{\mathbbm{1}}}
\newcommand {\bbtwo} {\ensuremath{\mathbbm{2}}}
\newcommand {\bbmono} {\ensuremath{\mathbb{M}}}
\newcommand {\bbem} {\ensuremath{\mathbb{M}}}
\newcommand {\ellStaged} {$\mathrm{L}^{\bbone\bbtwo}$}
\newcommand {\ellResid} {$\mathrm{L^R}$}
\newcommand {\ellTarget} {$\mathrm{L^T}$}
\newcommand {\lamStaged} {$\lambda^{\bbone\bbtwo}$}
\newcommand {\lamCircle} {$\lambda^{\fut}$}
\newcommand {\lamResid} {$\mathrm{\lambda^R}$}
\newcommand {\lamTarget} {$\mathrm{\lambda^T}$}
\newcommand {\lang} {\lamStaged}
\newcommand {\langTwo} {$\lambda^\bbtwo$}
\newcommand {\langmono} {$\lambda^{\textrm{U}}$}
\newcommand {\rmint} {{\rm int}}
\newcommand {\rmunit} {{\rm unit}}
\newcommand {\rmbool} {{\rm bool}}

% metatheory
\newcommand{\wfsym}{\ensuremath{\mathsf{wf}}}
\newcommand{\pvalsym}{\ensuremath{\mathsf{pval}}}
\newcommand{\ressym}{\ensuremath{\mathsf{res}}}
\newcommand{\valsym}{\ensuremath{\mathsf{val}}}
\newcommand{\fconsym}{\ensuremath{\mathsf{rtab}}}
\newcommand{\wf}{\ \wfsym}
\newcommand{\pval}{\ \pvalsym}
\newcommand{\res}{\ \ressym}
\newcommand{\val}{\ \valsym}
\newcommand{\fcon}{\ \fconsym}

% bnf stuff
\newcommand {\myit} [1]{\operatorname{\it{#1}}}
\newcommand {\stage} {\langle\mathit{stage}\rangle}
\newcommand {\type} {\tau}
\newcommand {\typeo} {\langle\bbone\text{-}\mathit{type}\rangle}
\newcommand {\typet} {\langle\bbtwo\text{-}\mathit{type}\rangle}
\newcommand {\expr} {e}
\newcommand {\brancho} {\langle\bbone\text{-}\mathit{brn}\rangle}
\newcommand {\brancht} {\langle\bbtwo\text{-}\mathit{brn}\rangle}
\newcommand {\expro} {\langle\bbone\text{-}\mathit{exp}\rangle}
\newcommand {\exprt} {\langle\bbtwo\text{-}\mathit{exp}\rangle}
%\newcommand {\val} {\langle\mathit{val}\rangle}
\newcommand {\valo} {\langle\bbone\text{-}\mathit{val}\rangle}
\newcommand {\valt} {\langle\bbtwo\text{-}\mathit{val}\rangle}
\newcommand {\world} {w}
\newcommand {\var} {x}
\newcommand {\emptyC} {\bullet}
\newcommand {\context} {\Gamma}
\newcommand {\inte} {i}
\newcommand {\bool} {b}
\newcommand {\resi} {\langle\mathit{res}\rangle}
\newcommand {\gbar} {~|~}

% nodes
\newcommand {\yhat} {\ensuremath{\mathtt{\hat y}}}
\newcommand {\pause} {{\tt hold}}
\renewcommand {\next} {{\tt next}}
\newcommand {\prev} {{\tt prev}}
\newcommand {\monoTerm} {{\tt mono}}
\newcommand {\monoType} {\nabla}
\newcommand {\curr} {\nabla}
\newcommand {\fut} {\bigcirc}
\newcommand {\inl} {{\tt inl}}
\newcommand {\inr} {{\tt inr}}
\newcommand {\pio} {{\tt pi1}}
\newcommand {\pit} {{\tt pi2}}
\newcommand {\roll} {{\tt roll}}
\newcommand {\unroll} {{\tt unroll}}
\newcommand {\lifttag} {{\tt liftTag}}
\newcommand {\liftint} {{\tt lift}}
\newcommand {\push} {{\tt unroll}}
\newcommand {\letin} [3] {{\tt let}１２荇轭３茴鬻泔眄犷莒弭盹铒鄢荇戾酤盹铒茺１荇荦浸２荇轭３茴鬻泔眄犷荇犰祆弭鄢茆彗轭狎蜥利炖荇戾酏１禁２荇轭苘３苠钿狎蜥茴鬻泔眄犷茔狍屣纨鄢荇汜箦１荇镦２荇３茴鬻泔眄犷荇犰煦狍妪鄢茆彗轭狎蜥利炖荇汜箦１荇镦苘２苘荇３苠钿狎蜥茴鬻泔眄犷荛骠桢铨鄢荇殒１荇翳孱２荇屐箦３茴鬻泔眄犷荇犰扉纨鄢茆彗轭狎蜥利炖荇殒１苘荇翳孱２苘荇屐箦３苠钿狎蜥茴鬻泔眄犷莒犴鄢莒犴怃猁１茼狒栩睇糊２３茴鬻泔眄犷荟犰痱镤鄄１２茴鬻泔眄犷莛蝻赈轭潺郾莒弭轭爝１莛檫１忑蜻１リ蹁珥孱趔茴鬻泔眄犷茔镬镱妪鄄１蝴２俐茆怙铄茴鬻泔眄犷茔镬赭稞鄄１蝴２俐茆怍黠茴鬻泔眄犷茔镬盹铒鄄１蝴２俐茆忭镱稞茴鬻泔眄犷茔镬睚鄄１蝴２俐茆忭镱稞茴鬻泔眄犷茔镬黠螨鄄１蝴２俐鼾茴鬻泔眄犷荇疱箫铄鄢圮轻眄彷１荟溽箬茔镬镱妍２３茴鬻泔眄犷荇疱篝黠鄢圮轻眄彷１荟溽箬茔镬赭稃２３茴鬻泔眄犷荇疱箜镱稞鄢圮轻眄彷１荟溽箬茔镬盹铒２３茴鬻泔眄犷荇疱箜鄢圮轻眄彷１荟溽箬茔镬睇２３茴鬻泔眄犷荇疱篦矧鄢圯芮犴磲１荟溽箬茔镬黠螓２３茴鬻泔眄犷荇疱簖鄢圮轻眄彷１荟溽箬２蝴３茴鬻泔眄犷荛篝疱镱妪茯豉疱俐茆怙铄茴鬻泔眄犷荛篝疱赭稞茯豉疱俐茆怍黠茴鬻泔眄犷荛篝疱黠螨茯豉疱俐鼾茴鬻泔眄犷荇疱箪犷缭黠鄢圮轻眄彷１荟溽箬哕忖赭２蝴３茴鬻泔眄犷茯彘纟鄢埯１畸２蒈秭弪箦酐引芤殓梏狎蝻鼷３茴鬻泔眄犷苠蜥箫铄苣秣钺蝌秣掊哕忖镱妪茴鬻泔眄犷苠蜥篝黠苣秣钺蝌秣掊哕忖赭稞茴鬻泔眄犷荛篥犰镱妪郾芮犴磲荟溽箬１茯鲠忑俐茆怙铄茴鬻泔眄犷荛篥犰赭稞茯鲠忑俐茆怍黠茴鬻泔眄犷荛篥犰黠螨茯鲠忑俐鼾ボ铄縻镯磲钿茯邃蹉屮痨鄞３苣秣钺蝌秣啕１摞２４ボ铄縻镯磲钿茯邃镱妪鄄１苣秣钺蝌秣哕忖镱遛２ボ铄縻镯磲钿茯邃赭稞鄄１苣秣钺蝌秣哕忖赭镛茆怍黠２ボ铄縻镯磲钿茯邃蹉鬻矧鄄１苣秣钺蝌秣喵尢２茴鬻泔眄犷荏疱泖矧鄄圯２茕秣钺蝌秣啕１ボ铄縻镯磲钿茕獒镱妪鄢圮轻眄彷１荟溽箬２苣秣钺蝌秣哕忖镱埯３蔟ボ铄縻镯磲钿茕獒赭稞鄢圮轻眄彷１荟溽箬２苣秣钺蝌秣哕忖赭３茴鬻泔眄犷茕獒镱妪鄢圮轻眄彷２苣秣钺蝌秣哕忖镱埯３蔟茴鬻泔眄犷茕獒赭稞鄢圮轻眄彷２苣秣钺蝌秣哕忖赭３茴鬻泔眄犷茯邃蹉妪鄄１苣秣钺蝌秣２茴鬻泔眄犷茯彘纟簌睚茱鲥蝮弭引芤殓梏狎蝻鼾茴鬻泔眄犷茯邃簌睚苣秣钺蝌秣茴鬻泔眄犷茯邃镱弩睚苣秣钺蝌秣哕忖镱妪茴鬻泔眄犷茯邃赭矬睚苣秣钺蝌秣哕忖赭稞茴鬻泔眄犷荇黠蝈潴睚茕秣钺蝌秣哕忖赭稞ボ铄縻镯磲钿茯邃蹉屣铄篚恺郾圯茯邃蹉屣铄暹１鲞１ボ铄縻镯磲钿茯邃蹉弭黠篚恺郾圯茯邃蹉弭黠暹１鲞１茴鬻泔眄犷茯邃蹉鬻矧篚恺郾圯茯邃蹉鬻矧暹１鲞１茴鬻泔眄犷荏疱泖矧篚恺郾圯荏疱泖矧暹１茴鬻泔眄犷茕獒镱弩踱郾圯茕獒镱妍暹１茗檫１祸啕１茴鬻泔眄犷茕獒赭矬踱郾圯茕獒赭稃暹１襁１茴鬻泔眄犷茼狍腼郾１啕茆怙铄茴鬻泔眄犷茼狍媵郾１啕茆怍黠茴鬻泔眄犷荟箴扉麸茱鲥蝮弭茆怙铄茔躜鲥狎蝻麾雉蜷玷酏茴鬻泔眄犷荟箴扉趑茱鲥蝮弭茆怍黠茔躜鲥狎蝻麾雉蜷玷酏茴鬻泔眄犷荇箴扉麸茱鲥蝮弭茆怙铄茔躜鲥狎蝻黩殓梏茴鬻泔眄犷荇箴扉趔茱鲥蝮弭茆怍黠茔躜鲥狎蝻黩殓梏茴鬻泔眄犷茔箴扉酏茔躜鲥狎蝻黩殓梏茴鬻泔眄犷荏箴扉酏茔躜鲥狎蝻麾雉蜷玷酏茴鬻泔眄犷荏痨轸镱弩睚茱鲥蝮弭茆怙铄茯殓梏篑蹰玑蝌秣茴鬻泔眄犷荏痨轸赭矬睚茱鲥蝮弭茆怍黠茯殓梏篑蹰玑蝌秣茴鬻泔眄犷荏痨轸镱妪鄞圮轻眄彷２荏痨轸镱弩莒彐糅４茯殓梏蔟茴鬻泔眄犷荏痨轸赭稞鄞圮轻眄彷２荏痨轸赭矬莒彐糅４茯殓梏蔟茴鬻泔眄犷荏痨轸镱弩踱鄢圮轻眄彷荏痨轸镱埯１暹２３氵２爝２蜻２茴鬻泔眄犷荏痨轸赭矬踱鄢圮轻眄彷荏痨轸赭埯１暹２３疬２爝２蜻２ロ轶茴鬻泔眄犷潲茕镯郾蓰茼狒梵纣滹睚ǎ暴茴鬻泔眄犷茜泔眇鄄茗檫１茗檫２茴鬻泔眄犷茕狯殄篾茱鲥蝮弭荑镲腧殓梏狎蝻鼾茴鬻泔眄犷茕狯殄箫茱鲥蝮弭荑镲腧殓梏狎蝻鼾ヤ彐狨祠篝蹑茴鬻泔眄犷荇荇疱箫铄茴鬻泔眄犷茯邃茯邃蹉茴鬻泔眄犷荏踱茯邃蹉屣铄篚茴鬻泔眄犷荏痨荏痨轸镱茴鬻泔眄犷茔镬茔镬镱ラ铈弪孱沐屮翦铙轱茴鬻泔眄犷荛铈弪豉疱篦矧鄢畚衔镣泡茯孱鬻泔眄犷荇荇疱篦矧茯孱鬻泔眄犷茔镬茔镬黠荛铈弪ホ茼狒栩睇１２３茴鬻泔眄犷荛铈弪蝈漉沐黠螨鄢畚衔镣泡茯孱鬻泔眄犷茯邃茯邃蹉鬻矧茯孱鬻泔眄犷荏踱茯邃蹉鬻矧篚荛铈弪圮磲翳蝽１苣秣钺蝌秣２３茴鬻泔眄犷荛铈弪蝈漉沐箴泯鄢畚衔镣泡茯孱鬻泔眄犷茯邃荏疱泖矧茯孱鬻泔眄犷荏踱荏疱泖矧篚荛铈弪圮磲翳蝽１茕秣钺蝌秣２３茴鬻泔眄犷荛铈弪溟犸铄鄢畚衔镣泡茯孱鬻泔眄犷茯邃茕獒镱茯孱鬻泔眄犷荏踱茕獒镱弩踱荛铈弪ホ茼狒栩睇１苣秣钺蝌秣哕忖镱妪２３茴鬻泔眄犷荛铈弪溟狍疸鄢畚衔镣泡茯孱鬻泔眄犷茯邃茕獒赭茯孱鬻泔眄犷荏踱茕獒赭矬踱荛铈弪ホ茼狒栩睇１苣秣钺蝌秣哕忖赭稞２３茴鬻泔眄犷荛铈弪箴扉麸铄鄢畚衔镣泡茯孱鬻泔眄犷荏痨荏痨轸镱茯孱鬻泔眄犷荏踱荏痨轸镱弩踱茯孱鬻泔眄犷茔镬茔镬镱荛铈弪ホ茼狒栩睇１茱鲥蝮弭茆怙铄茯殓梏篑蹰玑蝌秣２３茴鬻泔眄犷荛铈弪箴扉趑黠鄢畚衔镣泡茯孱鬻泔眄犷荏痨荏痨轸赭茯孱鬻泔眄犷荏踱荏痨轸赭矬踱茯孱鬻泔眄犷茔镬茔镬赭荛铈弪ホ茼狒栩睇１茱鲥蝮弭茆怍黠茯殓梏篑蹰玑蝌秣２３