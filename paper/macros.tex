% core conventions and language names
\newcommand {\bbone} {\mathbbm 1}
\newcommand {\bbtwo} {\mathbbm 2}
\newcommand {\ellStaged} {$\mathrm{L}^{\bbone\bbtwo}$}
\newcommand {\ellResid} {$\mathrm{L^R}$}
\newcommand {\ellTarget} {$\mathrm{L^T}$}
\newcommand {\lamStaged} {$\lambda^{\bbone\bbtwo}$}
\newcommand {\lamResid} {$\mathrm{\lambda^R}$}
\newcommand {\lamTarget} {$\mathrm{\lambda^T}$}
%\newcommand {\mono} {$\lambda$}
\newcommand {\rmunit} {{\rm unit}}
\newcommand {\rmbool} {{\rm bool}}

% bnf stuff
\newcommand {\myit} [1]{\operatorname{\it{#1}}}
\newcommand {\stage} {\langle\mathit{stage}\rangle}
\newcommand {\type} {\tau}
\newcommand {\typeo} {\langle\bbone\text{-}\mathit{type}\rangle}
\newcommand {\typet} {\langle\bbtwo\text{-}\mathit{type}\rangle}
\newcommand {\expr} {e}
\newcommand {\brancho} {\langle\bbone\text{-}\mathit{brn}\rangle}
\newcommand {\brancht} {\langle\bbtwo\text{-}\mathit{brn}\rangle}
\newcommand {\expro} {\langle\bbone\text{-}\mathit{exp}\rangle}
\newcommand {\exprt} {\langle\bbtwo\text{-}\mathit{exp}\rangle}
\newcommand {\val} {\langle\mathit{val}\rangle}
\newcommand {\valo} {\langle\bbone\text{-}\mathit{val}\rangle}
\newcommand {\valt} {\langle\bbtwo\text{-}\mathit{val}\rangle}
\newcommand {\world} {w}
\newcommand {\var} {x}
\newcommand {\emptyC} {\bullet}
\newcommand {\context} {\Gamma}
\newcommand {\inte} {i}
\newcommand {\bool} {b}
\newcommand {\resi} {\langle\mathit{res}\rangle}
\newcommand {\gbar} {~~|~~}

% nodes
\newcommand {\pause} {{\tt hold}}
\newcommand {\next} {{\tt next}}
\newcommand {\prev} {{\tt prev}}
\newcommand {\fut} {\bigcirc}
\newcommand {\inl} {{\tt inl}}
\newcommand {\inr} {{\tt inr}}
\newcommand {\pio} {{\tt pi1}}
\newcommand {\pit} {{\tt pi2}}
\newcommand {\letin} [3] {{\tt let}~{#1} = {#2}~{\tt in}~{#3}}
\newcommand {\talllet} [3] {\begin{array}{l} {\tt let}~{#1} = {#2}~{\tt in} \\ {#3}\end{array}}
\newcommand {\caseof} [3] {{\tt case}~{#1} ~{\tt of}~{#2}~{\tt |}~{#3}}
\newcommand {\tallcase} [3] {\begin{array}{l} {\tt case}~{#1} ~{\tt of}\\~~{#2}\\{\tt |}~{#3} \end{array}}
\newcommand {\ifthen} [3] {{\tt if}~{#1} ~{\tt then}~{#2}~{\tt else}~{#3}}
\newcommand {\tallif} [3] {\begin{array}{l} {\tt if}~{#1} \\{\tt then}~{#2}\\{\tt else}~{#3} \end{array}}
\newcommand {\lam} [3] {\lambda{#1}\mathrm{:}{#2}.{#3}}
\newcommand {\valprod} [2] {({#1},{#2})}
\newcommand {\valinl} {{\bf inl}}
\newcommand {\valinr} {{\bf inr}}
\newcommand {\valnext} {{\bf next}}
\newcommand {\vallam} [2] {{\bf \lambda}{#1}.{#2}}
\newcommand {\valdum} {{\bf dummy}}
\newcommand {\projbind} [1] {\letin{l_{#1}}{\pi_{#1} l}{r_{#1}}}

%judgements
\newcommand {\colone} [2] {{#1}:{#2}~@~\bbone}
\newcommand {\coltwo} [2] {{#1}:{#2}~@~\bbtwo}
\newcommand {\colwor} [2] {{#1}:{#2}~@~w}
\newcommand {\typesone} [3] [] { \Gamma{#1} \vdash \colone{#2}{#3}}
\newcommand {\typestwo} [3] [] { \Gamma{#1} \vdash \coltwo{#2}{#3}}
\newcommand {\typeswor} [3] [] { \Gamma{#1} \vdash \colwor{#2}{#3}}
\newcommand {\types} [3] [\Gamma] {{#1} \vdash {#2}:{#3}}
\newcommand {\istypeone} {~{\rm type}~@~\bbone}
\newcommand {\istypetwo} {~{\rm type}~@~\bbtwo}
\newcommand {\istypewor} {~{\rm type}~@~w}

\newcommand {\isvalone} {~{\rm val}~@~\bbone}
\newcommand {\isvaltwo} {~{\rm val}~@~\bbtwo}
\newcommand {\isvalwor} {~{\rm val}~@~w}
\newcommand {\reducexpl} [4] {{#3} \Downarrow_{#1}^{#2} {#4}}
\newcommand {\redone} [2] {{#1} \Downarrow_\bbone^L {#2}}
\newcommand {\redtwo} [2] {{#1} \Downarrow_\bbtwo^\bbtwo {#2}}
\newcommand {\reducewor} [2] {{#1} \Downarrow_w^L {#2}}
\newcommand {\specwor} [2] [] {{#2} \downarrow_{#1}}
%\newcommand {\rsone} [3] {{#1} \Downarrow_\bbone [{#2},{#3}]}
%\newcommand {\rstwo} [2] {{#1} \downarrow {#2}}
\newcommand {\reduce} [2] {{#1} \Downarrow {#2}}
%\newcommand {\reduceonesub} [1] [] {\reduceone{e_{#1}}{v_{#1}}}
%\newcommand {\reducetwosub} [1] [] {\reducetwo{e_{#1}}{v_{#1}}}
\newcommand {\reduceworsub} [1] [] {\reducewor{e_{#1}}{v_{#1}}}
\newcommand {\specworsub} [1] [] {\specwor{e_{#1}}}
%\newcommand {\rsonesub} [1] [] {\rsone{e_{#1}}{u_{#1}}{r_{#1}}}
%\newcommand {\rstwosub} [1] [] {\rstwo{e_{#1}}{r_{#1}}}

\newcommand {\vsplito} {\overset{\bbone}\curvearrowbotright}
\newcommand {\vsplits} {\overset{\bbtwo}\curvearrowbotright}
\newcommand {\tsplito} {\overset{\bbone}\curvearrowright}
\newcommand {\tsplits} {\overset{\bbtwo}\curvearrowright}
\newcommand {\csplit} {\curvearrowright}

\newcommand {\splitone} [4] [] { \Gamma{#1} \vdash {#2}:{#3} \overset{\bbone}\rightsquigarrow \left[{#4}\right]}
\newcommand {\splittwo} [4] [] { \Gamma{#1} \vdash {#2}:{#3} \overset{\bbtwo}\rightsquigarrow \left[{#4}\right]}
\newcommand {\splitonesub} [3] [] {\splitone [{#1}] {e_{#2}}{#3}{c_{#2}, l_{#2}.r_{#2}}}
\newcommand {\splittwosub} [3] [] {\splittwo [{#1}] {e_{#2}}{#3}{p_{#2}, l_{#2}.r_{#2}}}

%default stuff
\newcommand \ty \typesone
\newcommand \red \reduce
\newcommand \sub \reduceonesub
\newcommand \spl \splitone
\newcommand \col \colone

%inference extension
\newcommand {\infertypeswor}  [3] 
		[NONAME]{
			\renewcommand \ty \typeswor
			\renewcommand \col \colwor
			\infer [\mathrm{#1}] {#2}{#3}}
\newcommand {\inferreducewor} [3] 
		[NONAME]{
			\renewcommand \red \reducewor
			\renewcommand \sub \reduceworsub
			\infer [\mathrm{#1\Downarrow}] {#2}{#3}}
\newcommand {\inferreducespc} [3] 
		[NONAME]{
			\renewcommand \red \specwor
			\renewcommand \sub \specworsub
			\infer [\mathrm{#1\downarrow}] {#2}{#3}}
\newcommand {\infersplitone}  [3] 
		[NONAME]{
			\renewcommand \spl \splitone
			\renewcommand \sub \splitonesub
			\renewcommand \col \colone
			\infer [\mathrm{#1 \overset{\bbone}\rightsquigarrow}] {#2}{#3}}
\newcommand {\infersplittwo}  [3] 
		[NONAME]{
			\renewcommand \spl \splittwo
			\renewcommand \sub \splittwosub
			\renewcommand \col \coltwo
			\infer [\mathrm{#1 \overset{\bbtwo}\rightsquigarrow}] {#2}{#3}}
