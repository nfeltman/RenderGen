%!TEX root = ../paper.tex

\begin{figure*}
\begin{abstrsyn}

\textbf{Syntactically Separated Term with Stage \bbtwo\ Output ---
$\pipeS p l r$}
\begin{enumerate}
\item[] Precomputation $p$ is a monostaged term containing the program's
first-stage computations.
\item[] Resumer $l.r$ is a monostaged term containing the program's 
second-stage computations.
\item[] Evaluates via $\sepredtwo {\pipeS p l r} q$, where the resulting
residual $q$ is a monostaged term containing the remaining second-stage
computations.
\item[] $\sepredtwo {\pipeS p l r} {[b/l]r}$, where $b$ (the boundary value) is
generated by $\reduce p b$.
\end{enumerate}

\textbf{Syntactically Separated Term with Multistage Output ---
$\pipeM c l r$}
\begin{enumerate}
\item[] Combined result $c$ is a monostage term containing the program's
first-stage computations.
\item[] Resumer $l.r$ is a monostage term containing the program's 
second-stage computations.
\item[] Evaluates via $\sepredone {\pipeM c l r} {\mval i q}$, where 
$\mval i q$ is the resulting masked value (defined below).
\item[] $\sepredone {\pipeM c l r} {\mval i {[b/l]r}}$, where $b$ (the boundary
value) is generated by $\reduce c {\tup{i,b}}$.
\end{enumerate}

\textbf{Masked Values ---
$\mval i q$}
\begin{enumerate}
\item[] Immediate result $i$ is a monostaged value representing the first-stage
result.
\item[] Residual $q$ is a monostaged term representing the second-stage work
left to do.
\end{enumerate}

\end{abstrsyn}
\caption{Overview of the output terms of splitting.}
\label{fig:outputTermSummary}
\end{figure*}

\setlength{\unitlength}{2.8pt}
\begin{figure*}
\begin{abstrsyn}
\centering
\begin{tabular}{c|c}

{\Large \bf Splitting at World \bbonem} & 
{\Large \bf Splitting at World \bbtwo} \\ \hline

\begin{minipage}[t]{0.45\textwidth}
Splitting Terms: $(\colmix e A) \splitonesym \pipeM p l r$, where
\par \hspace{2em} $\colmix e A$ is the \lang\ input term to be split 
\par \hspace{2em} $\pipeM p l r$ is the syntactically separated result
\\
Masking Partial Values: $\rtab \xi v \vsplito \mval i q$, where
\par \hspace{2em} $\rtab \xi v$ is a partial value in \lang, resulting from $\redonesym$
\par \hspace{2em} $\mval i q$ is the resulting masked value
\end{minipage}
&

\begin{minipage}[t]{0.45\textwidth}
Splitting Terms: $(\coltwo e A) \splittwosym \pipeS p l r$, where 	
\par \hspace{2em} $\coltwo e A$ is the \lang\ input term to be split
\par \hspace{2em} $\pipeS p l r$ is the syntactically separated result
\end{minipage}

\\ 

\begin{picture} (80,54) (10,30)

\thicklines
\put(25,37){\oval(22,10)}
\put(25,75){\oval(22,10)}
\put(75,37){\oval(22,10)}
\put(75,75){\oval(22,10)}
\put(36,37){\vector(1,0){28}}
\put(36,75){\vector(1,0){28}}
\put(25,70){\vector(0,-1){28}}
\put(75,70){\vector(0,-1){28}}

\put(14,75){\raisebox{-0.5ex}{\makebox[22 \unitlength]{$\colmix e A$}}}
\put(14,37){\raisebox{-0.5ex}{\makebox[22 \unitlength]{$\rtab \xi v$}}}
\put(64,75){\raisebox{-0.5ex}{\makebox[22 \unitlength]{$\pipeM c l r$}}}
\put(64,37){\raisebox{-0.5ex}{\makebox[22 \unitlength]{$\mval i q$}}}

\put(25,78){\makebox[50 \unitlength]{Splitting $\left(\splitonesym\right)$}}
\put(25,32){\makebox[50 \unitlength]{Masking $\left(\vsplito\right)$}}
\put(76,55){\parbox[l]{20 \unitlength}{Separated-Form \\ Evaluation $\left(\sepredonesym\right)$}}
\put(9,55){\parbox[r]{20 \unitlength}{Interleaved \\ Evaluation $\left(\redonesym\right)$}}

\put(28,66){\parbox[t]{44 \unitlength}{ 
	\textbf{Correctness Condition:} \\ 
	Splitting followed by evaluation (top and right arrows)
	produce the same result as 
	evaluation followed by masking (left and bottom arrows),
	up to a term equivalence.
}}
\end{picture}

&
\begin{picture} (80,54) (10,30)

\thicklines
\put(25,75){\oval(22,10)}
\put(75,37){\oval(22,10)}
\put(75,75){\oval(22,10)}
\put(25,37){\vector(1,0){39}}
\put(36,75){\vector(1,0){28}}
\put(25,70){\line(0,-1){33}}
\put(75,70){\vector(0,-1){28}}

\put(14,75){\raisebox{-0.5ex}{\makebox[22 \unitlength]{$\coltwo e A$}}}
\put(64,75){\raisebox{-0.5ex}{\makebox[22 \unitlength]{$\pipeS p l r$}}}
\put(64,37){\raisebox{-0.5ex}{\makebox[22 \unitlength]{$q$}}}

\put(25,78){\makebox[50 \unitlength]{Splitting $\left(\splittwosym\right)$}}
\put(76,55){\parbox[l]{20 \unitlength}{Separated-Form \\ Evaluation $\left(\sepredtwosym\right)$}}
\put(9,55){\parbox[r]{20 \unitlength}{Interleaved \\ Evaluation $\left(\redtwosym\right)$}}

\put(28,66){\parbox[t]{44 \unitlength}{ 
	\textbf{Correctness Condition:} \\ 
	Splitting followed by evaluation (top and right arrows)
	produce the same result as 
	residualization (left and bottom arrow),
	up to a term equivalence.
}}
\end{picture}

\\ 

\end{tabular}


\end{abstrsyn}
\caption{Overview of splitting.}
\label{fig:splittingSummary}
\end{figure*}
