%!TEX root = ../paper.tex

\newcommand{\exprM}{e_\mathbbmss{M}}
\newcommand{\exprG}{e_\mathbbmss{G}}
\newcommand{\exprT}{e_\bbtwo}
\newcommand{\varM}{x_\mathbbmss{M}}
\newcommand{\varG}{x_\mathbbmss{G}}
\newcommand{\varT}{x_\bbtwo}
\newcommand{\typeM}{\tau_\mathbbmss{M}}
\newcommand{\typeG}{\tau_\mathbbmss{G}}
\newcommand{\typeT}{\tau_\bbtwo}

\begin{figure}[t]
\begin{abstrsyn}
\[\begin{aligned}
\text{Worlds}\ \ 
\world ::=\,& \bbonem \gbar \bbonep \gbar \bbtwo  \\
%
\text{\{\bbonem,\bbtwo\}-Types}\ \ 
\type ::=\,& \text{unit}
 \gbar \type \times \type
 \gbar \type \to \type
 \gbar \alpha \gbar \mu \alpha.\tau 
 \gbar \tau + \tau \\
 %
\typeM ::=\,& \text{unit}
 \gbar \typeM \times \typeM
 \gbar \typeM \to \typeM
 \gbar \alpha \gbar \mu \alpha.\typeM 
 \gbar \fut \tau 
 \gbar \curr \tau \\
%
%\text{Types}\ \ 
%\type ::=\,& \text{unit}%\gbar\text{int}%~|~\text{bool}
% \gbar \type \times \type
% \gbar \type + \type \\
%\gbar& \type \to \type
% \gbar \alpha \gbar \mu \alpha.\tau \\
%\gbar& \fut \type 
% \gbar \curr \type \\
%
\text{Contexts}\ \ 
\context ::=\,&\emptyC
 \gbar \context, x_w:\tau_w~@~w \\
%\context ::=\,&\emptyC \gbar \context, \colwor \var \type \\
%
\text{Terms}\ \ 
e_w ::=\,& \app {e_w} {e_w} 
 \gbar \tup{e_w, e_w}
 \gbar \pio {e_w} 
 \gbar \pit {e_w} \\
\gbar& \inl {e_w} \gbar \inr {e_w}
 \gbar \caseof {e_w}{\var.e_w}{\var.e_w} \\
\gbar& \roll {e_w} \gbar \unroll {e_w} \\
\exprM ::=\,& \exv v
 \gbar \next \exprT 
 \gbar \pure \exprG 
 \gbar \letp \varG \exprM \exprM \\
\gbar& \caseP \exprM {\varM.\exprM} {\varM.\exprM} \\
\exprG ::=\,& \exv u \\ 
\exprT ::=\,& \exv q
 \gbar \prev \exprM 
 \gbar \fix \varT \varT \exprT \\ 
\text{Partial Values}\ \ 
v ::=\,& \varM
 \gbar\tup{}
 \gbar \fix \varM \varM \exprM
 \gbar \tup{v, v} 
 \gbar \roll v \\
\gbar& \inl v 
 \gbar \inr v 
 \gbar \next y
 \gbar \pure v \\
\text{Ground Values}\ \ 
u ::=\,& \varG
 \gbar\tup{}
 \gbar \fix \varG \varG \exprG
 \gbar \tup{u, u} 
 \gbar \roll u
 \gbar \inl u 
 \gbar \inr u \\
\text{Residuals}\ \ 
q ::=\,& \varT
 \gbar \tup{}
 \gbar \fix \varT \varT q
 \gbar \app q q 
 \gbar \tup{q, q} 
 \gbar \pio q 
 \gbar \pit q \\
\gbar& \roll q
 \gbar \unroll q
 \gbar \inl q 
 \gbar \inr q
 \gbar \caseof {q}{\varT.q}{\varT.q} \\
\end{aligned}\]
\end{abstrsyn}
\caption{\lang\ abstract syntax. Subscript-$w$ rules apply at all worlds.}
\label{fig:grammar}
\end{figure}
