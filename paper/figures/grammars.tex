%!TEX root = ../paper.tex

\newcommand{\exprM}{e_\mathbbmss{M}}
\newcommand{\exprG}{e_\mathbbmss{G}}
\newcommand{\exprT}{e_\bbtwo}
\newcommand{\varM}{x_\mathbbmss{M}}
\newcommand{\varG}{x_\mathbbmss{G}}
\newcommand{\varT}{x_\bbtwo}
\newcommand{\typeM}{\tau_\mathbbmss{M}}
\newcommand{\typeG}{\tau_\mathbbmss{G}}
\newcommand{\typeT}{\tau_\bbtwo}

\begin{figure}
\begin{abstrsyn}
\[\begin{aligned}
\text{Worlds}\ \ 
\world &::= \bbonem \gbar \bbonep \gbar \bbtwo  \\
%
\text{Types}\ \ 
\type_w &::= \text{unit}
 \gbar \type_w \times \type_w \\
&\gbar \type_w \to \type_w
 \gbar \alpha_w \gbar \mu \alpha_w.\tau_w \\
 %
\typeM &::= \fut \typeT \gbar \curr \typeG \\
%
\typeG &::= \typeG + \typeG \\
%
\typeT &::= \typeT + \typeT \\
%
%\text{Types}\ \ 
%\type &::= \text{unit}%\gbar\text{int}%~|~\text{bool}
% \gbar \type \times \type
% \gbar \type + \type \\
%&\gbar \type \to \type
% \gbar \alpha \gbar \mu \alpha.\tau \\
%&\gbar \fut \type 
% \gbar \curr \type \\
%
\text{Contexts}\ \ 
\context &::=\emptyC
 \gbar \context, x_w:\tau_w~@~w \\
%\context &::=\emptyC \gbar \context, \colwor \var \type \\
%
\text{Terms}\ \ 
e_w &::= x_w
 \gbar \tup{}
 \gbar \fix {x_w} {x_w} {e_w}
 \gbar \app {e_w} {e_w} \\
&\gbar \tup{e_w, e_w} 
 \gbar \pio {e_w} 
 \gbar \pit {e_w} \\
\exprM &::= \exv v
 \gbar \next \exprT 
 \gbar \pure \exprG \\
&\gbar \letp \varG \exprM \exprM \\
&\gbar \caseP \exprM {\varM.\exprM} {\varM.\exprM} \\
\exprG &::= \exv u
 \gbar \roll \exprG \gbar \unroll \exprG \\
&\gbar \inl \exprG \gbar \inr \exprG
 \gbar \caseof {\exprG}{\var.\exprG}{\var.\exprG} \\ 
\exprT &::= \exv q
 \gbar \roll \exprT \gbar \unroll \exprT \\
&\gbar \inl \exprT \gbar \inr \exprT
 \gbar \caseof {\exprT}{\var.\exprT}{\var.\exprT} \\ 
\text{Partial Values}\ \ 
v &::= \varM
 \gbar\tup{}
 \gbar \fix \varM \varM \exprM
 \gbar \tup{v, v} \\
&\gbar \next {\hat y} 
 \gbar \pure v \\
\text{Ground Values}\ \ 
u &::= \varG
 \gbar\tup{}
 \gbar \fix \varG \varG \exprG
 \gbar \tup{u, u} \\
&\gbar \inl u 
 \gbar \inr u \\
\text{Residuals}\ \ 
q &::= \varT
 \gbar \tup{}
 \gbar \fix \varT \varT q
 \gbar \app q q \\
&\gbar \tup{q, q} 
 \gbar \pio q 
 \gbar \pit q \\
&\gbar \inl q 
 \gbar \inr q
 \gbar \caseof {q}{\varT.q}{\varT.q} \\
&\gbar \roll q
 \gbar \unroll q\\
\end{aligned}\]
\end{abstrsyn}
\caption{\lang\ abstract syntax. Subscript-$w$ rules apply at all worlds.}
\label{fig:grammar}
\end{figure}
